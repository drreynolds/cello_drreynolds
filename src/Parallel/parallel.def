// $Id: parallel.def 1711 2010-08-16 18:51:52Z bordner $
// See LICENSE_CELLO file for license and copyright information

#ifndef PARALLEL_DEF
#define PARALLEL_DEF

/// @file     parallel.def
/// @author   James Bordner (jobordner@ucsd.edu)
/// @date     Mon Aug 13 2010
/// @brief    Macro definitions for the Parallel component

#if defined(CONFIG_USE_CHARM)

#  define PARALLEL_INIT      /* BLANK */
#  define PARALLEL_EXIT      CkExit()
#  define PARALLEL_PRINTF    CkPrintf
#  define PARALLEL_ARGC      main->argc
#  define PARALLEL_ARGV      main->argv
#  define PARALLEL_MAIN_BEGIN  \
      CProxy_Main mainProxy; \
         class Main : public CBase_Main { \
            public:\
               Main(CkArgMsg* main)
#  define PARALLEL_MAIN_END };

#  define PARALLEL_CHARM_INCLUDE(FILE) #FILE

#elif defined(CONFIG_USE_MPI)

#include <mpi.h>

#  define PARALLEL_INIT      MPI_Init(&PARALLEL_ARGC,&PARALLEL_ARGV)
#  define PARALLEL_EXIT      MPI_Finalize(); exit(0);
#  define PARALLEL_PRINTF    printf
#  define PARALLEL_ARGC      argc
#  define PARALLEL_ARGV      argv
#  define PARALLEL_MAIN_BEGIN int main(int argc, char ** argv)
#  define PARALLEL_MAIN_END   /* BLANK */
#  define PARALLEL_CHARM_INCLUDE(FILE) "/dev/null"

#else /* serial */

#  define PARALLEL_INIT      /* BLANK */
#  define PARALLEL_EXIT      exit(0)
#  define PARALLEL_PRINTF    printf
#  define PARALLEL_ARGC      argc
#  define PARALLEL_ARGV      argv
#  define PARALLEL_MAIN_BEGIN int main(int argc, char ** argv)
#  define PARALLEL_MAIN_END   /* BLANK */
#  define PARALLEL_CHARM_INCLUDE(FILE) "/dev/null"

#endif

#endif /* PARALLEL_HPP */

%0       1         2         3         4         5         6         7         8
%2345678901234567890123456789012345678901234567890123456789012345678901234567890
%=======================================================================
\documentclass{book}
%=======================================================================

\newcommand{\req}[3]{
\begin{tabular}{rl}
ID & \textbf{R#1} \\
Status & \textsf{#2} \\
Acceptance & \textit{#3}
\end{tabular}
}

\include{include}

%=======================================================================

\begin{document}

%=======================================================================
\TITLE{\cello\ Software Requirements Specification}{James Bordner}{$Rev$}
%=======================================================================

\tableofcontents

%=======================================================================
\chapter{Introduction} \label{c:intro}
%=======================================================================

\section{Purpose}
\section{Scope}
\section{Definitions, acronyms, abbreviations}
\section{References}
\section{Overview}

%=======================================================================
\chapter{Overall Description} \label{c:descr}
%=======================================================================
\section{Product perspective}
\section{Product functions}
\section{User characteristics}
\section{Constraints}
\section{Assumptions and dependencies}

%=======================================================================
\chapter{Specific Requirements} \label{c:req}
%=======================================================================

%=======================================================================
\section{System}
%=======================================================================

\begin{enumerate}
\item  All software in the system will be open source
\item  Multiple simulations will be supported (optional)
\item  The system will contain no problem-dependent code
\item  The user may supply problem-dependent initialization routines
\item  All problems are specified using a single user-written parameter file
\item  Parameter files may include other parameter files (optional)
\item  Initial conditions may be initialized using data files
\item  Expressive power of parameter files is sufficient to specify all \enzo\ test problems without problem-dependent routines that can be run given the supported physics capabilities
\item  Expressive power of parameter files is sufficient to specify all standard test problems that can be run given the supported physics capabilities
\item Parameters shall be sufficient for deep control of all physics, algorithms, and data structures
\item The system shall support simulations in $1$D, $2$D, and $3$D
\item The system shall support text logging of the history and current state of the simulation
\item The system shall support simple visualization logging (plots, graphs, field data, and particle data)
\item All logging data will be available from a single file (e.g. web page)
\item The system shall enable external modification of physics and
  data-structure parameters of a running simulation
\item The system shall attempt to detect and recover from numerical errors (NaN, Inf)
\item The system shall attempt to detect and recover from loss of a core, process, or node
\item The system shall attempt to detect and recover from memory errors
\item The system shall attempt to detect and recover from communication errors
\item The system shall attempt to detect and recover from disk errors
\item The system shall support checkpoint / restart to disk
\item The system shall support checkpoint / restart to memory
\end{enumerate}

%=======================================================================
\section{Problem definition}
%=======================================================================

\begin{enumerate}
 \item Problems shall be fully defined using an input text file, called
  the ``parameter file''
  \item Problems may input HDF5 files as part of the parameter
  \item No assumptions shall be made on field variable names in the source
  code
  \item parameter files shall be sufficiently powerful to define
  all standard test problems
  \item parameter files shall support defining general subregions of space for initial conditions
  \item parameter files shall support constructing composite
  regions using intersection, union, and set difference on simple
  regions
  \item Composite regions shall not have any imposed restriction on number
  of constituent simple regions
  \item parameter files shall support defining field properties
  within a regions
  \item Field properties may vary between regions
  \item Numerical values in parameter files may include arithmetic
  operations
  \item Numerical values in parameter files may include the
  functions \code{log}, \code{exp}, \code{sin}, \code{cos},
  \code{min}, \code{max}
  \item Numerical values in parameter files may include \code{x},
  \code{y}, \code{z}, and \code{t} to represent spacial and temporal
  coodinates
\end{enumerate}

%=======================================================================
\section{Methods}
%=======================================================================

\begin{enumerate}
  \item The system shall support systems of coupled PDE's involving hyperbolic conservation and elliptic equations

  \item The system shall perform hydrodynamics computations with at least
  2nd order in both space and time ``almost everywhere''

  \item The system shall perform self-gravity computations with at least
  2nd order accuracy in both space and time ``almost everywhere''

  \item The system shall support cosmological expansion as an option

  \item The system shall perform radiative cooling computations

  \item The system shall perform multispecies chemistry computations

  \item The system shall perform star-formation computations

  \item The system shall perform magnetohydrodynamic computations

  \item The system shall perform radiative transfer computations
\end{enumerate}

%=======================================================================
\section{Fields}
%=======================================================================


\begin{enumerate}
  \item The system shall be able to represent ideal gas density, velocity,
  and @@@energy

  \item The system shall be able to represent dark matter density and
  velocity

  \item The system should support multiple ideal gases

  \item Simulation dynamic resolution range @@@ glossary: dynamic
  resolution range: shall be at least $2^64$, e.g.~$1024^3$
  @@@glossary: root grid: with $27$ additional levels of refinement by
  $4$)

  \item Simulation resolution range should be at least $2^128$

  \item Simulation size shall be virtually unbounded (run on largest
  parallel computer available)
\end{enumerate}

%=======================================================================
\section{Particles}
%=======================================================================

%=======================================================================
\section{Multiresolution}
%=======================================================================

%=======================================================================
\section{Performance}
%=======================================================================

\begin{enumerate}
  \item The system shall support multiple levels of parallelism

  \item The system shall support a data-parallel model using point-to-point
  @@@glossary MPI-1 communication

  \item The system may support a data-parallel model using one-sided
  @@@glossary MPI-2 communication

  \item The system shall support multiple levels of parallelism

  \item The system shall support OpenMP shared memory parallelism with
  parallel efficiency at least $80\%$ of maximum based on flops and
  memory relative to single-core up to $100$ cores

  \item The system shall support uniform resolution problems with at least
  $10\%$ average core flop rate on largest platform sizes available

  \item The system shall support moderately non-uniform resolution problems
  (dynamic resolution range of $2^32$) with at least $3\%$ average
  core flop rate on largest platform sizes available

  \item The system shall support highly non-uniform resolution problems
  (dynamic resolution range of $2^48$) with $1\%$ average core flop
  rate and $50\%$ parallel efficiency on largest platform sizes
  available

  \item The system shall support highly non-uniform resolution problems on
  the largest platform sizes available that have at least $1GB$ memory
  per computational element
\end{enumerate}

%=======================================================================
\section{WIKI Wish List}
%=======================================================================

\begin{description}
 \item[W001] Integrate "inits" functionality into the main code
 \item[W002] Support ensembles within a single run, including inline-analysis
 \item[W003] Support multiple (hybrid) and flexible parallelization strategies, including MPI-1 (2-sided send/recv), MPI-2 (1-sided get/put), OMP, and optionally UPC and GPU
 \item[W004] Reduce implicit dependencies by dynamically allocating parallel tasks, ala CHARM++
 \item[W005] Auto-tune where possible--automatically optimize for cache-, parallel-, vector-, solver-, etc. parameters
 \item[W006] Use object-oriented design, organize into components (subdirectories) of classes (*.hpp/*.cpp files)
 \item[W007] Require more rigorous coding standards compared to Enzo development
 \item[W008] Enforce strict control over data storage formats (e.g. files) (see W0009)
 \item[W009] Require that all stored data be accessed through standard interface functions that are independent of specific file formats (i.e., stored datasets are conceptually treated as objects)
 \item[W010] Support both structured AMR (Enzo-like) and tree-based AMR
 \item[W011] Store particle positions in single precision as -1 <= x,y,z <= 1 relative to their containing patch
 \item[W012] Do not store a patch's global position, only local position relative to immediate neighbors, parent, and children
 \item[W013] Represent patch extents with (small) integer values relative to parent
 \item[W014] Provide (or notify) neighboring patches with updated ghost zone data as soon as it's available
 \item[W015] Support optional variable timestep sizes within each level
 \item[W016] Support optional uniform timesteps across all levels
 \item[W017] User-controlled optional floor/ceiling limits on individual Fields (ala "tiny\_number" in Enzo), with user-specified Error behavior (warning, error, ignore, reset to given floor/ceiling, etc.)
 \item[W018] Allow multiple root-level patches per MPI task
 \item[W019] Use a binary tree data-structure to recursively partition the bounding boxes of particles
 \item[W020] For very deep AMR where coarser levels never complete their timestep, delete coarse levels to free storage
 \item[W021] Relax rigid refinement criteria to inhibit excessive changes in octree-like tree refinement
 \item[W022] Support for user-supplied code for problem initialization
 \item[W023] Load-balance by having over-loaded processors reassign tasks to random processes
 \item[W024] Load-balance using "over-compensation", since heavily-loaded processes tend to continue to become more heavily loaded (cosmology / star-formation application-dependent)
 \item[W025] Reduce tree-AMR node size by only storing parent, single neighbor, and single child
 \item[W026] Support flexible node types: memory-efficient versus compute-efficient
 \item[W027] Support temporary "allocate as-needed" ghost zones in addition to "permanent" ones
 \item[W028] Only use inter-core, inter-cpu, inter-node, etc. level-communicators to bound communicator size and manage communication nonuniformity
\end{description}

%=======================================================================
\section{Input}
%=======================================================================

\begin{itemize}
\item Problem
\item Physics
\item Algorithms
\item Data
\item Parallel
\item I/O
\item Performance
\end{itemize}

%=======================================================================
\section{Output}
%=======================================================================

%-----------------------------------------------------------------------
\req
  {}
  {Proposed}
%
  {}

\appendix


\end{document}

%==================================================================
